package core

import (
	"github.com/stretchr/testify/assert"
	"testing"
)

func TestRemoveUnexpectedQuote(t *testing.T) {

	type TestingData struct {
		Parameter interface{}
		Expected  interface{}
	}

	testCase := []TestingData{
		{
			Parameter: `{"data":{"meta_data":{"orders":[{"additional_fee":0,"address":{"address_name":"pergudangan pantai indah dadap blok E.1","city":144,"city_name":"Kab. Tangerang","country_name":"Indonesia","district":1603,"district_name":"Kosambi","id":38790783,"latitude":"-6.089518080321505","longitude":"106.70965053141117","phone":"081294610656","postal":"12345","province":11,"province_name":"Banten","receiver_name":"chandra suryanto"},"dest_city":144,"dest_province":11,"insurance_price":0,"invoice_ref_num":"INV/20190429/XIX/IV/305328701","is_gold_shop":false,"is_official_store":false,"is_power_badge":false,"order_id":305325904,"product_details":[{"OrderDetailID":490087123,"category_id":2787,"etalase_id":9064041,"price_per_item":18000,"product_id":246905665,"product_name":"Kopi bubuk Aming Pontianak 200 gr / Aming Coffee / Kopi Pontianak","quantity":2,"total_price":36000}],"shipping_id":1,"shipping_price":9000,"shop_id":2476519,"sp_id":1,"total_product_price":36000,"total_weight":0.5,"unique_id":"2476519-0-0-38790783","cod":{"is_cod":false,"fee":0},"order_priority":{"is_order_prioritas":false,"fee":0},"trade_in":{"price":0,"final_price":0,"convenience_fee":0,"convenience_id":0,"commission_id":0,"is_trade_in":false}},{"additional_fee":0,"address":{"address_name":"pergudangan pantai indah dadap blok E.1","city":144,"city_name":"Kab. Tangerang","country_name":"Indonesia","district":1603,"district_name":"Kosambi","id":38790783,"latitude":"-6.089518080321505","longitude":"106.70965053141117","phone":"081294610656","postal":"12345","province":11,"province_name":"Banten","receiver_name":"chandra suryanto"},"dest_city":144,"dest_province":11,"insurance_price":0,"invoice_ref_num":"INV/20190429/XIX/IV/305328702","is_gold_shop":true,"is_official_store":false,"is_power_badge":true,"order_id":305325905,"product_details":[{"OrderDetailID":490087124,"category_id":2788,"etalase_id":2438441,"price_per_item":69900,"product_id":47150667,"product_name":"Kopi Arabika Java Preanger Tilu | Kopi Tiwus di Film "Filosofi Kopi"","quantity":1,"total_price":69900}],"shipping_id":1,"shipping_price":9000,"shop_id":826747,"sp_id":1,"total_product_price":69900,"total_weight":0.23,"unique_id":"826747-0-0-38790783","cod":{"is_cod":false,"fee":0},"order_priority":{"is_order_prioritas":false,"fee":0},"trade_in":{"price":0,"final_price":0,"convenience_fee":0,"convenience_id":0,"commission_id":0,"is_trade_in":false}}]},"payment_amount":123900,"payment_id":384005245,"payment_info":{"bank_account_number":"","card_type_id":0,"cc_exp_month":0,"cc_exp_year":0,"cc_hash":"","credit_card_number":"","klik_bca_user_name":"","mandiri_click_pay_number":"","payment_gateway":0},"promo_code_id":30004687123,"secret_key":"9136a5d48e5883ffbe731e1b322cd5eb7dfb4f6a6","service_id":731644293353960,"user_data":{"advertisement_id":"08b19362-3f83-4626-bd4d-548236dfc863","app_version":"3.29","device_id":"dT6tEwA71-o:APA91bGyoSMhT9e861WwreJXxlkgKfgWFF-lDprQm451aRkNFGa7ovLAK3q0S9p7WhP2S_NBBbWJv4TkKv_AufDmTRz5xtojNLyGfT5AS1EkePWsfPYEoZdGvF7czz1MAfaj8Gcp8U4e","device_type":"android","email":"djandrabegundal@gmail.com","ip_address":"114.124.179.227","is_qc_acc":false,"msisdn":"081294610656","msisdn_verified":true,"user_agent":"Mozilla/5.0 (iPod; CPU iPhone OS 5_0_1 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Version/5.1 Mobile/9A405 Safari/7534.48.3","user_id":22120742}}}`,
			Expected:  `{"data":{"meta_data":{"orders":[{"additional_fee":0,"address":{"address_name":"pergudangan pantai indah dadap blok E.1","city":144,"city_name":"Kab. Tangerang","country_name":"Indonesia","district":1603,"district_name":"Kosambi","id":38790783,"latitude":"-6.089518080321505","longitude":"106.70965053141117","phone":"081294610656","postal":"12345","province":11,"province_name":"Banten","receiver_name":"chandra suryanto"},"dest_city":144,"dest_province":11,"insurance_price":0,"invoice_ref_num":"INV/20190429/XIX/IV/305328701","is_gold_shop":false,"is_official_store":false,"is_power_badge":false,"order_id":305325904,"product_details":[{"OrderDetailID":490087123,"category_id":2787,"etalase_id":9064041,"price_per_item":18000,"product_id":246905665,"product_name":"Kopi bubuk Aming Pontianak 200 gr / Aming Coffee / Kopi Pontianak","quantity":2,"total_price":36000}],"shipping_id":1,"shipping_price":9000,"shop_id":2476519,"sp_id":1,"total_product_price":36000,"total_weight":0.5,"unique_id":"2476519-0-0-38790783","cod":{"is_cod":false,"fee":0},"order_priority":{"is_order_prioritas":false,"fee":0},"trade_in":{"price":0,"final_price":0,"convenience_fee":0,"convenience_id":0,"commission_id":0,"is_trade_in":false}},{"additional_fee":0,"address":{"address_name":"pergudangan pantai indah dadap blok E.1","city":144,"city_name":"Kab. Tangerang","country_name":"Indonesia","district":1603,"district_name":"Kosambi","id":38790783,"latitude":"-6.089518080321505","longitude":"106.70965053141117","phone":"081294610656","postal":"12345","province":11,"province_name":"Banten","receiver_name":"chandra suryanto"},"dest_city":144,"dest_province":11,"insurance_price":0,"invoice_ref_num":"INV/20190429/XIX/IV/305328702","is_gold_shop":true,"is_official_store":false,"is_power_badge":true,"order_id":305325905,"product_details":[{"OrderDetailID":490087124,"category_id":2788,"etalase_id":2438441,"price_per_item":69900,"product_id":47150667,"product_name":"Kopi Arabika Java Preanger Tilu | Kopi Tiwus di Film -Filosofi Kopi-","quantity":1,"total_price":69900}],"shipping_id":1,"shipping_price":9000,"shop_id":826747,"sp_id":1,"total_product_price":69900,"total_weight":0.23,"unique_id":"826747-0-0-38790783","cod":{"is_cod":false,"fee":0},"order_priority":{"is_order_prioritas":false,"fee":0},"trade_in":{"price":0,"final_price":0,"convenience_fee":0,"convenience_id":0,"commission_id":0,"is_trade_in":false}}]},"payment_amount":123900,"payment_id":384005245,"payment_info":{"bank_account_number":"","card_type_id":0,"cc_exp_month":0,"cc_exp_year":0,"cc_hash":"","credit_card_number":"","klik_bca_user_name":"","mandiri_click_pay_number":"","payment_gateway":0},"promo_code_id":30004687123,"secret_key":"9136a5d48e5883ffbe731e1b322cd5eb7dfb4f6a6","service_id":731644293353960,"user_data":{"advertisement_id":"08b19362-3f83-4626-bd4d-548236dfc863","app_version":"3.29","device_id":"dT6tEwA71-o:APA91bGyoSMhT9e861WwreJXxlkgKfgWFF-lDprQm451aRkNFGa7ovLAK3q0S9p7WhP2S_NBBbWJv4TkKv_AufDmTRz5xtojNLyGfT5AS1EkePWsfPYEoZdGvF7czz1MAfaj8Gcp8U4e","device_type":"android","email":"djandrabegundal@gmail.com","ip_address":"114.124.179.227","is_qc_acc":false,"msisdn":"081294610656","msisdn_verified":true,"user_agent":"Mozilla/5.0 (iPod; CPU iPhone OS 5_0_1 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Version/5.1 Mobile/9A405 Safari/7534.48.3","user_id":22120742}}}`,
		},
	}

	for _, test := range testCase {
		jsInput := test.Parameter.(string)
		jsExpected := test.Expected.(string)

		result := RemoveUnexpectedQuote(jsInput)
		assert.Equal(t, jsExpected, result)
	}
}
